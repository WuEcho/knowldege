# solidity知识补充

- 1.在Solidity中，动态类型（如bytes和string）在内存中的存储方式是：前32个字节存储该数据的长度，真正的数据从后面开始

#### 动态类型：
动态数据类型是那些其大小在编译时不能确定，只有在运行时根据实际数据内容才能确定的类型。常见的动态数据类型包括:

- 1. bytes 类型
  - 这是一个变长的字节数组，可以存储任意长度的二进制数据。
  - 例如：bytes memory data = new bytes(10); 表示一个长度为10的字节数组。
  - 它与定长的bytes1到bytes32不同，bytes是变长的。
- 2. string 类型
  - string类型用于存储UTF-8编码的变长字符串。
  - 例如：string memory name = "Hello, Solidity!";
  - 底层存储方式与bytes类似，本质上是一个动态字节数组，但用于文本数据。
- 3. array（动态数组）
  - 动态数组可以存储任意数量的元素，数组长度在运行时可以动态调整。
  - 例如：uint; 是一个长度为5的uint类型动态数组。
  - 与定长数组（如uint[10]）不同，动态数组在运行时可以修改其长度。
- 4. mapping
  - 虽然mapping不是直接存储动态大小的数据类型，但它是一个键值对存储结构，类似于哈希表，支持动态地增加键值对。
  - 例如：mapping(address => uint) balances; 可以存储任意数量的address到uint的映射。
  - mapping是动态的，因为键值对的数量可以根据需要增加或减少。
- 5. 结构体（struct）中的动态成员
  - 如果struct中的某个成员是动态数据类型（如bytes、string或动态数组），整个结构体也可以被视为部分动态的。

#### mapping在合约存储中的存储方式
mapping类型是一种特殊的动态数据结构，它允许将键值对存储在合约的存储中。然而，mapping的工作方式和存储方式与普通的数组或其他数据类型不同，尤其是在内存中的表现。

 - `mapping` 的每一个值并没有按顺序存储在特定的存储槽上，而是通过计算得出的存储槽位置来存取数据。
 - `mapping[key]` 的存储位置由`keccak256(h(key) . p) `决定，其中 p 是 mapping 所在的存储槽索引，key 是映射的键，. 表示拼接操作。这个哈希值是这个键对应的值的存储位置。


